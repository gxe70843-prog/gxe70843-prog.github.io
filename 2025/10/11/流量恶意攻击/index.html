<!doctype html>
<html lang="zh"><head>
<title>流量分析恶意攻击 - X8@0E的博客</title>
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta name="description" content="场景概述你有一个网络流量文件（比如 .pcap 或 .pcapng），其中包含了一些攻击者IP的恶意活动。你的目标是：  识别出这些恶意操作的类型。 理解每种操作的流量特征。 确定并定位出攻击者的IP地址。   第一部分：常见的恶意操作及其流量特征以下是一些最常见的恶意操作，以及它们在流量数据中呈现出的特征。 1. 端口扫描与主机发现这是攻击的前期侦察阶段，目的是发现网络上存活的主机和开放的服务。">
<meta property="og:type" content="article">
<meta property="og:title" content="流量分析恶意攻击">
<meta property="og:url" content="http://example.com/2025/10/11/%E6%B5%81%E9%87%8F%E6%81%B6%E6%84%8F%E6%94%BB%E5%87%BB/index.html">
<meta property="og:site_name" content="X8@0E的博客">
<meta property="og:description" content="场景概述你有一个网络流量文件（比如 .pcap 或 .pcapng），其中包含了一些攻击者IP的恶意活动。你的目标是：  识别出这些恶意操作的类型。 理解每种操作的流量特征。 确定并定位出攻击者的IP地址。   第一部分：常见的恶意操作及其流量特征以下是一些最常见的恶意操作，以及它们在流量数据中呈现出的特征。 1. 端口扫描与主机发现这是攻击的前期侦察阶段，目的是发现网络上存活的主机和开放的服务。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-11T14:56:51.455Z">
<meta property="article:modified_time" content="2025-10-25T07:55:13.743Z">
<meta property="article:author" content="X8@0E">
<meta name="twitter:card" content="summary">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1765187748431">

<link rel="stylesheet" href="/css/style.css?v=1765187748431">




    
        <link rel="stylesheet" href="/custom.css?v=1765187748431">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1765187748431"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
<meta name="generator" content="Hexo 7.3.0"></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(https://img-baofun.zhhainiao.com/pcwallpaper_ugc/static/55f0c32a6a773efe8c6a6a8158a06f18.jpg?x-oss-process=image%2fresize%2cm_lfit%2cw_1920%2ch_1080)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="X8@0E"><img src="https://n.sinaimg.cn/sinakd20119/560/w1080h1080/20220924/802a-0c9750f1fa5aa25624c0847a082aaba1.jpg" alt="X8@0E"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="X8@0E">
            <img src="https://n.sinaimg.cn/sinakd20119/560/w1080h1080/20220924/802a-0c9750f1fa5aa25624c0847a082aaba1.jpg" alt="X8@0E" alt="X8@0E">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>49</div>
        <div><span>标签</span>80</div>
        <div><span>分类</span>16</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archives.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-douban-fill"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        
            <form id="search_form">
                <label><input class="st-default-search-input" id="search_value" name="q" type="search" placeholder="搜索" style="
                    font-size: 15px !important;
                    height: 56px !important;
                    background-image: none;
                "></label>
            </form>
         
    </div>
</div>


	<script async src="/js/search.js?v=1765187748432"></script>



    
        
        <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="https://blog.csdn.net/2301_81325456/article/details/147025965"
			target="_blank"
			mdui-tooltip="{content: 'CSDN'}"
			style="
				color: rgb(247, 132, 34);
				background-color: rgba(247, 132, 34, .1);
			"
		>
			<i
				class="nexmoefont icon-github"
			></i> </a
		>
	</div>
</div>

    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Crypto/">Crypto</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/NSSCTF/">NSSCTF</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/SQL注入/">SQL注入</a>
          <span class="category-list-count">7</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Vulnhub/">Vulnhub</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Vulnvm靶机复现/">Vulnvm靶机复现</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ctfshow-web-信息收集/">ctfshow-web-信息收集</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ctfshow-web-命令执行/">ctfshow-web-命令执行</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ctfshow-web-文件上传/">ctfshow-web-文件上传</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ctfshow-web-文件包含/">ctfshow-web-文件包含</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/ctfshow-web-爆破/">ctfshow-web-爆破</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/sql注入/">sql注入</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/vulhub/">vulhub</a>
          <span class="category-list-count">7</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/vulnhub/">vulnhub</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/春秋云镜-com/">春秋云镜.com</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/群友靶机/">群友靶机</a>
          <span class="category-list-count">15</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/自制靶机/">自制靶机</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/1Panel/" style="font-size: 10px;">1Panel</a> <a href="/tags/3%E4%B8%AA%E7%82%B9/" style="font-size: 10px;">3个点</a> <a href="/tags/Argon2Cracker/" style="font-size: 10px;">Argon2Cracker</a> <a href="/tags/Cookie-GLOBALS/" style="font-size: 10px;">Cookie--GLOBALS</a> <a href="/tags/Cypher%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">Cypher注入</a> <a href="/tags/DC/" style="font-size: 13.33px;">DC</a> <a href="/tags/GIF%E7%BB%95%E8%BF%87/" style="font-size: 10px;">GIF绕过</a> <a href="/tags/Jinja2/" style="font-size: 10px;">Jinja2</a> <a href="/tags/JoomScan/" style="font-size: 10px;">JoomScan</a> <a href="/tags/LFI%E5%88%B0RCE-open%E5%87%BD%E6%95%B0/" style="font-size: 10px;">LFI到RCE(open函数)</a> <a href="/tags/NSSCTF/" style="font-size: 13.33px;">NSSCTF</a> <a href="/tags/Nginx%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">Nginx解析漏洞</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/RUNPATH/" style="font-size: 10px;">RUNPATH</a> <a href="/tags/Rabbit/" style="font-size: 10px;">Rabbit</a> <a href="/tags/SQL/" style="font-size: 20px;">SQL</a> <a href="/tags/SQLMAP/" style="font-size: 10px;">SQLMAP</a> <a href="/tags/SSRF/" style="font-size: 10px;">SSRF</a> <a href="/tags/Vulnhub/" style="font-size: 13.33px;">Vulnhub</a> <a href="/tags/Vulnvm/" style="font-size: 10px;">Vulnvm</a> <a href="/tags/WAF/" style="font-size: 10px;">WAF</a> <a href="/tags/WPA-01-cap/" style="font-size: 10px;">WPA-01.cap</a> <a href="/tags/aircrack-ng/" style="font-size: 10px;">aircrack-ng</a> <a href="/tags/basic%E8%AE%A4%E8%AF%81%E7%88%86%E7%A0%B4/" style="font-size: 10px;">basic认证爆破</a> <a href="/tags/cgi%E6%96%87%E4%BB%B6/" style="font-size: 10px;">cgi文件</a> <a href="/tags/ctfshow/" style="font-size: 16.67px;">ctfshow</a> <a href="/tags/dirtycow/" style="font-size: 10px;">dirtycow</a> <a href="/tags/docker%E4%BA%A4%E4%BA%92%E5%BC%8Fshell/" style="font-size: 10px;">docker交互式shell</a> <a href="/tags/drupal/" style="font-size: 10px;">drupal</a> <a href="/tags/ffuf/" style="font-size: 10px;">ffuf</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/fork%E8%A7%A3%E5%86%B3%E6%96%AD%E8%BF%9E/" style="font-size: 10px;">fork解决断连</a> <a href="/tags/ftp/" style="font-size: 10px;">ftp</a> <a href="/tags/ghfs/" style="font-size: 10px;">ghfs</a> <a href="/tags/ldd/" style="font-size: 10px;">ldd</a> <a href="/tags/les-sh/" style="font-size: 10px;">les.sh</a> <a href="/tags/linpeas-sh/" style="font-size: 10px;">linpeas.sh</a> <a href="/tags/lsattr-%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%B1%9E%E6%80%A7/" style="font-size: 10px;">lsattr--查看文件扩展属性</a> <a href="/tags/motto/" style="font-size: 10px;">motto</a> <a href="/tags/msfvenom/" style="font-size: 13.33px;">msfvenom</a> <a href="/tags/mysql-old-password/" style="font-size: 10px;">mysql_old_password</a> <a href="/tags/nikto/" style="font-size: 10px;">nikto</a> <a href="/tags/nohup/" style="font-size: 10px;">nohup</a> <a href="/tags/openfire/" style="font-size: 10px;">openfire</a> <a href="/tags/php%E6%8F%90%E6%9D%83root/" style="font-size: 10px;">php提权root</a> <a href="/tags/poc/" style="font-size: 10px;">poc</a> <a href="/tags/put%E6%96%B9%E6%B3%95/" style="font-size: 10px;">put方法</a> <a href="/tags/python3-5/" style="font-size: 10px;">python3.5</a> <a href="/tags/rce/" style="font-size: 10px;">rce</a> <a href="/tags/readelf/" style="font-size: 10px;">readelf</a> <a href="/tags/scp/" style="font-size: 10px;">scp</a> <a href="/tags/sqlmap/" style="font-size: 10px;">sqlmap</a> <a href="/tags/sql%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">sql二次注入</a> <a href="/tags/ssh%E5%BC%B1%E5%8F%A3%E4%BB%A4%E7%88%86%E7%A0%B4/" style="font-size: 10px;">ssh弱口令爆破</a> <a href="/tags/ssh%E7%A7%98%E9%92%A5%E7%94%9F%E6%88%90%E8%BF%9E%E6%8E%A5/" style="font-size: 10px;">ssh秘钥生成连接</a> <a href="/tags/stegseek/" style="font-size: 10px;">stegseek</a> <a href="/tags/suForce/" style="font-size: 10px;">suForce</a> <a href="/tags/url%E6%88%AA%E6%96%AD/" style="font-size: 10px;">url截断</a> <a href="/tags/vite/" style="font-size: 10px;">vite</a> <a href="/tags/web%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" style="font-size: 10px;">web命令执行</a> <a href="/tags/web%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size: 10px;">web文件上传</a> <a href="/tags/web%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size: 10px;">web文件包含</a> <a href="/tags/web%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/" style="font-size: 10px;">web源码泄露</a> <a href="/tags/web%E7%88%86%E7%A0%B4/" style="font-size: 10px;">web爆破</a> <a href="/tags/x-forwarded-for%E7%9A%84ip%E6%AC%BA%E9%AA%97/" style="font-size: 10px;">x-forwarded-for的ip欺骗</a> <a href="/tags/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-CVE-2025-30208/" style="font-size: 10px;">任意文件读取漏洞(CVE-2025-30208)</a> <a href="/tags/%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81/" style="font-size: 10px;">凯撒密码</a> <a href="/tags/%E5%90%8E%E9%9D%A2%E5%8A%A0-jpg%E5%90%8E%E7%BC%80/" style="font-size: 10px;">后面加.jpg后缀</a> <a href="/tags/%E5%9F%9F%E6%8E%A7/" style="font-size: 10px;">域控</a> <a href="/tags/%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/" style="font-size: 10px;">密码爆破</a> <a href="/tags/%E6%8F%90%E6%9D%83-env-reset/" style="font-size: 10px;">提权!env_reset</a> <a href="/tags/%E6%8F%92%E4%BB%B6%E6%BC%8F%E6%B4%9E/" style="font-size: 10px;">插件漏洞</a> <a href="/tags/%E6%97%A5%E5%BF%97%E6%B3%A8%E5%85%A5-ua%E6%B7%BB%E5%8A%A0%E6%9C%A8%E9%A9%AC/" style="font-size: 10px;">日志注入+ua添加木马</a> <a href="/tags/%E6%AD%A3%E5%90%91shell/" style="font-size: 10px;">正向shell</a> <a href="/tags/%E7%8A%B6%E6%80%81%E7%A0%81/" style="font-size: 10px;">状态码</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" style="font-size: 10px;">环境变量</a> <a href="/tags/%E7%A9%BA%E6%A0%BC/" style="font-size: 10px;">空格</a> <a href="/tags/%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81/" style="font-size: 10px;">维吉尼亚密码</a> <a href="/tags/%E8%9A%81%E5%89%91/" style="font-size: 10px;">蚁剑</a> <a href="/tags/%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96/" style="font-size: 10px;">越界读取</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(80);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/">2025</a><span class="archive-list-count">49</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2025/11/19/openfire/">CVE-2023-323115</a>
          </li>
        
          <li>
            <a href="/2025/11/13/SQL%E6%B3%A8%E5%85%A5-SQLMAP%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/">SQL注入-SQLMAP基础使用</a>
          </li>
        
          <li>
            <a href="/2025/11/13/SQL%E6%B3%A8%E5%85%A5-HTTP%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5/">SQL注入-HTTP头部注入</a>
          </li>
        
          <li>
            <a href="/2025/11/13/SQL%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84%E7%9B%B2%E6%B3%A8/">SQL注入-基于时间的盲注</a>
          </li>
        
          <li>
            <a href="/2025/11/12/SQL%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8E%E5%B8%83%E5%B0%94%E7%9A%84%E7%9B%B2%E6%B3%A8/">SQL注入-基于布尔的盲注</a>
          </li>
        
      </ul>
    </div>
  </div>

    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-link">
		<ul>
        
            <li>
                <a href="" target="_blank" >
                    <img src="https://n.sinaimg.cn/sinakd20119/560/w1080h1080/20220924/802a-0c9750f1fa5aa25624c0847a082aaba1.jpg" alt="X8@0E"></img>
                    <p>X8@0E</p>
                </a>
            </li>
        
		</ul>
    </div>
</div>
<style>
.nexmoe-widget-wrap .nexmoe-link ul li a {
    text-align : center;
}
.nexmoe-widget-wrap .nexmoe-link ul li a img {
    max-width : 100%;
}
.nexmoe-widget-wrap .nexmoe-link ul li a p {
    margin: 10px 0;
}
</style>

    
   
    <div class="nexmoe-copyright">
        &copy; 2025 X8@0E
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover absolute" style="padding-top: NaN%;"> 
            <img src="https://ts1.tc.mm.bing.net/th/id/R-C.c2b8f09f937ec83e04f8e565dfe5920a?rik=ntASURd6WwLWzQ&riu=http%3a%2f%2fimg.52desk.com%2ftp%2f193501YIKpT.jpg&ehk=a%2bvFJw8mJJ7jrNnz2jhI1EC0P35x1xrM2nggDUYMuus%3d&risl=&pid=ImgRaw&r=0" alt="流量分析恶意攻击" loading="lazy">
            <h1>流量分析恶意攻击</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2025年10月11日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/NSSCTF/">NSSCTF</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h3 id="场景概述"><a href="#场景概述" class="headerlink" title="场景概述"></a>场景概述</h3><p>你有一个网络流量文件（比如 <code>.pcap</code> 或 <code>.pcapng</code>），其中包含了一些攻击者IP的恶意活动。你的目标是：</p>
<ol>
<li><strong>识别</strong>出这些恶意操作的类型。</li>
<li><strong>理解</strong>每种操作的流量特征。</li>
<li><strong>确定</strong>并定位出攻击者的IP地址。</li>
</ol>
<hr>
<h3 id="第一部分：常见的恶意操作及其流量特征"><a href="#第一部分：常见的恶意操作及其流量特征" class="headerlink" title="第一部分：常见的恶意操作及其流量特征"></a>第一部分：常见的恶意操作及其流量特征</h3><p>以下是一些最常见的恶意操作，以及它们在流量数据中呈现出的特征。</p>
<h4 id="1-端口扫描与主机发现"><a href="#1-端口扫描与主机发现" class="headerlink" title="1. 端口扫描与主机发现"></a>1. 端口扫描与主机发现</h4><p>这是攻击的前期侦察阶段，目的是发现网络上存活的主机和开放的服务。</p>
<ul>
<li><strong>恶意操作</strong>：<ul>
<li><strong>TCP SYN 扫描</strong>： 向目标的一系列端口发送TCP SYN包。</li>
<li><strong>UDP 扫描</strong>： 向目标的UDP端口发送数据包。</li>
<li><strong>ICMP 扫描</strong>： 发送ICMP Echo请求（Ping）来发现存活主机。</li>
</ul>
</li>
<li><strong>流量特征</strong>：<ul>
<li><strong>高频率、小范围</strong>： 在很短的时间内，从一个IP向另一个IP的<strong>多个不同端口</strong>发送大量连接请求。</li>
<li><strong>没有完整连接</strong>： 对于TCP SYN扫描，你会看到大量<code>SYN</code>包，但很少有后续的<code>SYN-ACK</code>或<code>ACK</code>（这意味着连接没有建立起来）。</li>
<li><strong>ICMP不可达响应</strong>： 对于UDP扫描，可能会看到来自目标的“ICMP Port Unreachable”响应，这表明端口是关闭的。</li>
<li><strong>统计异常</strong>： 在流量统计中，该源IP的“连接数&#x2F;秒”或“数据包&#x2F;秒”会远高于正常用户。</li>
</ul>
</li>
</ul>
<h4 id="2-暴力破解"><a href="#2-暴力破解" class="headerlink" title="2. 暴力破解"></a>2. 暴力破解</h4><p>攻击者尝试用大量的用户名和密码组合来登录服务，如SSH、RDP、FTP、Web表单等。</p>
<ul>
<li><strong>恶意操作</strong>： 对同一个服务进行大量的认证尝试。</li>
<li><strong>流量特征</strong>：<ul>
<li><strong>固定的目标IP和端口</strong>： 流量集中在一个IP的一个特定服务端口上（如TCP&#x2F;22 for SSH, TCP&#x2F;3389 for RDP）。</li>
<li><strong>重复的协议模式</strong>： 你会看到大量、快速的“登录请求 -&gt; 登录失败”的协议交互。</li>
<li><strong>高失败率</strong>： 在流量内容中（如果未加密），你可以看到大量的<code>HTTP 401 Unauthorized</code>、<code>SSH Authentication Failed</code>等响应。</li>
<li><strong>规律性</strong>： 请求之间的时间间隔可能很规律（如工具自动发送）。</li>
</ul>
</li>
</ul>
<h4 id="3-漏洞利用"><a href="#3-漏洞利用" class="headerlink" title="3. 漏洞利用"></a>3. 漏洞利用</h4><p>攻击者利用软件或协议中的漏洞来获得未授权的访问或执行代码。</p>
<ul>
<li><strong>恶意操作</strong>： 向目标服务发送精心构造的、异常的恶意数据包。</li>
<li><strong>流量特征</strong>：<ul>
<li><strong>协议异常</strong>： 数据包违反协议规范，例如异常的TCP标志位组合、过大的数据包、畸形的HTTP请求头等。</li>
<li><strong>Shellcode特征</strong>： 负载中可能包含可执行的机器代码（shellcode），在Wireshark中查看时会显示为一长串十六进制字符。</li>
<li><strong>缓冲区溢出尝试</strong>： 在请求字段中填充超长字符串。</li>
<li><strong>特定攻击载荷</strong>： 负载中可能包含已知漏洞的利用代码或命令（如 <code>../../../etc/passwd</code> 路径遍历，或 <code>union select</code> SQL注入语句）。</li>
</ul>
</li>
</ul>
<h4 id="4-拒绝服务攻击"><a href="#4-拒绝服务攻击" class="headerlink" title="4. 拒绝服务攻击"></a>4. 拒绝服务攻击</h4><p>目的是耗尽目标系统的资源（带宽、CPU、内存），使其无法提供正常服务。</p>
<ul>
<li><strong>恶意操作</strong>：<ul>
<li><strong>流量洪泛</strong>： 如ICMP Flood, UDP Flood, SYN Flood。</li>
<li><strong>应用层DDoS</strong>： 如HTTP Flood。</li>
</ul>
</li>
<li><strong>流量特征</strong>：<ul>
<li><strong>极高的流量速率</strong>： 流量图上会出现一个明显的峰值。</li>
<li><strong>来源分散</strong>： 对于分布式攻击，会有大量不同的IP向同一个目标IP发送流量。</li>
<li><strong>协议单一</strong>： 在SYN Flood中，你会看到海量的TCP SYN包；在UDP Flood中，则是海量的UDP包。</li>
<li><strong>无业务逻辑</strong>： 发送的流量是随机的或无意义的，不像正常用户那样有完整的会话交互。</li>
</ul>
</li>
</ul>
<h4 id="5-命令与控制"><a href="#5-命令与控制" class="headerlink" title="5. 命令与控制"></a>5. 命令与控制</h4><p>攻击成功后，受害主机（僵尸）会与攻击者的C2服务器建立连接，接受指令。</p>
<ul>
<li><strong>恶意操作</strong>： 受感染的内网主机与一个外部IP进行周期性、隐蔽的通信。</li>
<li><strong>流量特征</strong>：<ul>
<li><strong>周期性心跳</strong>： 受感染主机会以固定的时间间隔（如每60秒）向C2服务器发送一个小数据包（如TCP、HTTP、DNS请求），表示“我还活着”。</li>
<li><strong>非标准端口</strong>： C2通信经常使用常见的端口（如TCP&#x2F;80, TCP&#x2F;443）来伪装成Web流量，但协议可能不是标准的HTTP&#x2F;HTTPS。</li>
<li><strong>长连接</strong>： 连接可能会保持很长时间，但数据传输量很小。</li>
<li><strong>DNS隧道</strong>： 利用DNS查询和响应记录来传输数据，你会看到大量异常的、长字符串的DNS查询请求（例如 <code>long-encrypted-string.malicious.com</code>）。</li>
</ul>
</li>
</ul>
<h4 id="6-数据外泄"><a href="#6-数据外泄" class="headerlink" title="6. 数据外泄"></a>6. 数据外泄</h4><p>攻击者将窃取的数据从内部网络传输到外部。</p>
<ul>
<li><strong>恶意操作</strong>： 将大量数据从目标网络内部发送到一个外部IP。</li>
<li><strong>流量特征</strong>：<ul>
<li><strong>出站流量激增</strong>： 一个内部IP向某个外部IP发起了大量的出站连接，且数据传输量异常大（尤其是上传流量）。</li>
<li><strong>协议</strong>： 可能使用FTP、HTTP POST、或加密的HTTPS&#x2F;TCP连接。</li>
<li><strong>数据模式</strong>： 如果未加密，你可能会在数据包中看到文件头信息（如 <code>PK</code> 表示ZIP文件，<code>%PDF</code> 表示PDF文档）或数据库转储的明文。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="第二部分：如何在流量中分析并确定攻击者IP"><a href="#第二部分：如何在流量中分析并确定攻击者IP" class="headerlink" title="第二部分：如何在流量中分析并确定攻击者IP"></a>第二部分：如何在流量中分析并确定攻击者IP</h3><p>现在，我们使用工具（如 <strong>Wireshark</strong>）来执行分析。</p>
<h4 id="步骤一：宏观统计，寻找异常"><a href="#步骤一：宏观统计，寻找异常" class="headerlink" title="步骤一：宏观统计，寻找异常"></a>步骤一：宏观统计，寻找异常</h4><ol>
<li><strong>打开流量文件</strong>，首先查看 <strong>Statistics -&gt; Conversations</strong>。</li>
<li><strong>切换到IPv4&#x2F;IPv6标签页</strong>。这里会列出所有通信的IP对以及数据包数量、字节数。</li>
<li><strong>排序</strong>：<ul>
<li><strong>按数据包数量排序</strong>： 排名前列的对话中，如果有一个IP与大量其他IP通信（可能是扫描），或者两个IP之间有异常多的数据包（可能是暴力破解或数据外泄），这些就是可疑对象。</li>
<li><strong>按字节数排序</strong>： 找出传输数据量最大的对话。如果一个内部IP向外部IP发送了远超寻常的数据量，极有可能是<strong>数据外泄</strong>。</li>
</ul>
</li>
</ol>
<h4 id="步骤二：使用过滤器精准定位"><a href="#步骤二：使用过滤器精准定位" class="headerlink" title="步骤二：使用过滤器精准定位"></a>步骤二：使用过滤器精准定位</h4><p>Wireshark的显示过滤器是你的核心武器。</p>
<ul>
<li><strong>寻找扫描器</strong>：<ul>
<li><code>ip.src == 192.168.1.100 &amp;&amp; tcp.flags.syn==1 &amp;&amp; tcp.flags.ack==0</code><ul>
<li>这能过滤出IP <code>192.168.1.100</code> 发出的所有SYN扫描包。如果这个列表很长，且目标端口分散，那它就是个扫描器。</li>
</ul>
</li>
</ul>
</li>
<li><strong>寻找暴力破解</strong>：<ul>
<li><code>ip.src == 192.168.1.100 &amp;&amp; tcp.port == 22</code><ul>
<li>查看该IP对SSH端口的访问频率。再追踪一个TCP流，看看里面是不是充满了登录失败的报文。</li>
</ul>
</li>
</ul>
</li>
<li><strong>寻找C2心跳</strong>：<ul>
<li><code>frame.time_delta &gt; 59 &amp;&amp; frame.time_delta &lt; 61</code><ul>
<li>这个过滤器可以尝试找出时间间隔大约为60秒的数据包，有助于发现心跳流量。需要结合对话列表来判断。</li>
</ul>
</li>
</ul>
</li>
<li><strong>寻找特定攻击字符串</strong>：<ul>
<li><code>http.request.uri contains “../../../”</code></li>
<li><code>tcp contains “union select”</code><ul>
<li>这些过滤器可以直接在流量中搜索已知的攻击特征。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="步骤三：深入流量，验证判断"><a href="#步骤三：深入流量，验证判断" class="headerlink" title="步骤三：深入流量，验证判断"></a>步骤三：深入流量，验证判断</h4><ol>
<li><strong>右键点击可疑的数据包 -&gt; Follow -&gt; TCP Stream&#x2F;UDP Stream&#x2F;HTTP Stream</strong>。</li>
<li>这会将整个会话的内容重组并显示出来。在这里你可以清晰地看到：<ul>
<li>完整的HTTP请求和响应。</li>
<li>SSH或FTP的登录过程。</li>
<li>执行的命令。</li>
<li>传输的文件内容。</li>
</ul>
</li>
<li>这是<strong>最终确认</strong>恶意操作性质的<strong>最关键一步</strong>。</li>
</ol>
<h4 id="步骤四：综合判断攻击者IP"><a href="#步骤四：综合判断攻击者IP" class="headerlink" title="步骤四：综合判断攻击者IP"></a>步骤四：综合判断攻击者IP</h4><p>通过以上分析，你可以得出结论：</p>
<ul>
<li><strong>攻击者IP通常是流量的源IP</strong>。但在DDoS或反射攻击中，源IP可能是被伪造或利用的傀儡机。</li>
<li><strong>核心逻辑是：寻找行为异常的IP</strong>。<ul>
<li>谁在<strong>频繁地扫描</strong>端口？ -&gt; 攻击者IP</li>
<li>谁在<strong>不停地尝试登录</strong>？ -&gt; 攻击者IP</li>
<li>谁在接收<strong>大量外泄数据</strong>？ -&gt; 攻击者IP（C2服务器）</li>
<li>谁在发送<strong>大量攻击载荷</strong>？ -&gt; 攻击者IP</li>
<li>哪个<strong>外部IP</strong>在与我的内网主机进行<strong>周期性通信</strong>？ -&gt; 攻击者IP（C2服务器）</li>
</ul>
</li>
</ul>
<h3 id="总结与工作流"><a href="#总结与工作流" class="headerlink" title="总结与工作流"></a>总结与工作流</h3><ol>
<li><strong>统计先行</strong>： 用 <code>Conversations</code> 和 <code>Protocol Hierarchy</code> 宏观把握，找到“最忙”和“最异常”的IP。</li>
<li><strong>过滤聚焦</strong>： 使用Wireshark过滤器，针对特定协议、标志位、字符串进行精准搜索。</li>
<li><strong>流分析确认</strong>： 对任何可疑的会话，使用 <code>Follow Stream</code> 功能查看完整内容，这是取证的黄金标准。</li>
<li><strong>交叉验证</strong>： 一个IP可能进行多种恶意操作（例如，先扫描，发现22端口开放后，接着进行SSH暴力破解）。将这些点串联起来，能更完整地描绘出攻击链。</li>
</ol>
<p>通过这个系统性的方法，你就可以从一个原始的流量文件中，有效地挖掘出攻击者的IP地址和他们所进行的全部恶意操作。</p>
<h3 id="常见的恶意操作及其流量特征（详解）"><a href="#常见的恶意操作及其流量特征（详解）" class="headerlink" title="常见的恶意操作及其流量特征（详解）"></a>常见的恶意操作及其流量特征（详解）</h3><p>攻击活动在流量中会留下独特的“指纹”，我们可以从<strong>协议行为、数据包速率、负载内容、会话模式</strong>等多个维度进行识别。</p>
<h4 id="1-侦察阶段：端口扫描与主机发现"><a href="#1-侦察阶段：端口扫描与主机发现" class="headerlink" title="1. 侦察阶段：端口扫描与主机发现"></a>1. 侦察阶段：端口扫描与主机发现</h4><p>这是攻击的“敲门”阶段，目标是绘制网络地图。</p>
<ul>
<li><strong>主要技术</strong>：<ul>
<li><strong>TCP SYN 扫描</strong>： 发送TCP SYN包到目标端口。如果收到SYN-ACK，则端口开放；如果收到RST，则端口关闭。</li>
<li><strong>TCP Connect 扫描</strong>： 完成完整的TCP三次握手。</li>
<li><strong>UDP 扫描</strong>： 发送UDP包到目标端口。如果收到ICMP端口不可达，则端口关闭；否则可能开放。</li>
<li><strong>ICMP 扫描</strong>： 发送ICMP Echo请求，根据是否有Reply判断主机是否在线。</li>
</ul>
</li>
<li><strong>核心流量特征</strong>：<ul>
<li><strong>来源集中，目标分散</strong>： <strong>一个源IP</strong>在极短时间内，向<strong>一个目标IP的多个端口</strong>，或向<strong>一个网段的多个IP</strong>发送探测包。</li>
<li><strong>高包量，低交互</strong>： 在<code>Statistics -&gt; Conversations</code>中，该源IP的数据包数量和连接数会排名靠前，但<strong>数据传输的字节数通常很小</strong>，因为只是探测。</li>
<li><strong>协议标志异常</strong>：<ul>
<li><strong>SYN扫描</strong>： 流量中充满 <code>[SYN]</code> 和 <code>[RST-ACK]</code> 的响应，几乎没有成功的 <code>[SYN-ACK] -&gt; [ACK]</code> 完整握手。</li>
<li><strong>僵尸扫描</strong>： 会出现来源IP伪造的、带有异常标志位组合的数据包。</li>
</ul>
</li>
<li><strong>时序特征</strong>： 数据包发送速率极快，间隔均匀，是工具自动化的明显标志。</li>
</ul>
</li>
</ul>
<h4 id="2-入侵阶段：暴力破解"><a href="#2-入侵阶段：暴力破解" class="headerlink" title="2. 入侵阶段：暴力破解"></a>2. 入侵阶段：暴力破解</h4><p>试图用“穷举法”猜出合法凭证，从而获得访问权限。</p>
<ul>
<li><strong>主要目标</strong>： SSH (22), RDP (3389), FTP (21), Telnet (23), Web登录页面 (80&#x2F;443), 数据库 (3306, 1433) 等。</li>
<li><strong>核心流量特征</strong>：<ul>
<li><strong>目标固定</strong>： 流量持续指向<strong>特定目标IP的特定服务端口</strong>。</li>
<li><strong>重复的认证模式</strong>： 在追踪TCP流时，你会看到大量、快速重复的“认证请求-失败响应”循环。<ul>
<li><strong>SSH</strong>： 连续的 <code>SSH: Client: Authentication (failed)</code> 报文。</li>
<li><strong>HTTP</strong>： 大量的 <code>POST /login.php</code> 请求，伴随 <code>HTTP 401 Unauthorized</code> 或 <code>200 OK with login failed page</code> 响应。</li>
<li><strong>FTP</strong>： 连续的 <code>USER</code> 和 <code>PASS</code> 命令，以及 <code>530 Login incorrect</code> 响应。</li>
</ul>
</li>
<li><strong>高频率</strong>： 认证尝试的频率远超人类手动操作，每秒可能发生数次甚至数十次。</li>
<li><strong>用户名字典</strong>： 在流量中可以看到工具尝试了大量的不同用户名和密码。</li>
</ul>
</li>
</ul>
<h4 id="3-入侵阶段：漏洞利用"><a href="#3-入侵阶段：漏洞利用" class="headerlink" title="3. 入侵阶段：漏洞利用"></a>3. 入侵阶段：漏洞利用</h4><p>利用软件、系统或协议中的安全缺陷，来获取系统控制权。</p>
<ul>
<li><strong>主要形式</strong>： 缓冲区溢出、SQL注入、跨站脚本、远程代码执行、反序列化漏洞等。</li>
<li><strong>核心流量特征</strong>：<ul>
<li><strong>载荷内容异常</strong>：<ul>
<li><strong>缓冲区溢出</strong>： 在请求的某个字段中出现<strong>超长字符串</strong>，意图填满并溢出内存缓冲区。</li>
<li><strong>SQL注入</strong>： 在HTTP请求的URI或POST参数中包含 <code>&#39;</code>、<code>union select</code>、<code>or 1=1</code>、<code>sleep(</code> 等SQL关键字和语法。</li>
<li><strong>路径遍历</strong>： 包含大量的 <code>../</code> 序列，试图访问系统敏感文件（如 <code>../../../etc/passwd</code>）。</li>
<li><strong>命令注入</strong>： 包含系统命令，如 <code>; cat /etc/passwd</code>、<code>| whoami</code> 等。</li>
<li><strong>Shellcode</strong>： 负载中包含一串可执行的机器码（在十六进制视图里像是一长串<code>90 90 90 E8 CF...</code>的序列）。</li>
</ul>
</li>
<li><strong>协议规约违反</strong>： 发送不符合RFC标准的畸形数据包，例如异常的HTTP方法、畸形的TCP序列号、不合法的TLS握手等，旨在触发目标系统的解析错误。</li>
</ul>
</li>
</ul>
<h4 id="4-破坏阶段：拒绝服务攻击"><a href="#4-破坏阶段：拒绝服务攻击" class="headerlink" title="4. 破坏阶段：拒绝服务攻击"></a>4. 破坏阶段：拒绝服务攻击</h4><p>旨在耗尽目标资源，使其无法提供正常服务。</p>
<ul>
<li><strong>主要类型</strong>：<ul>
<li><strong>流量型DDoS</strong>： 用巨大的流量堵塞带宽（如UDP Flood, ICMP Flood）。</li>
<li><strong>协议型DDoS</strong>： 利用协议特性消耗服务器资源（如SYN Flood）。</li>
<li><strong>应用层DDoS</strong>： 模拟大量“合法”请求消耗应用性能（如HTTP Flood）。</li>
</ul>
</li>
<li><strong>核心流量特征</strong>：<ul>
<li><strong>流量洪峰</strong>： 在 <code>Statistics -&gt; I/O Graph</code> 中，会看到一个突然的、持续的巨大流量峰值。</li>
<li><strong>来源特征</strong>：<ul>
<li><strong>分布式攻击</strong>： 海量<strong>不同的源IP</strong>向<strong>同一个目标IP</strong>发送数据，在Conversations中，目标IP的包量和字节数独占鳌头。</li>
<li><strong>反射&#x2F;放大攻击</strong>： 源IP是伪造的，流量主要由响应包构成（如大量的DNS响应、NTP响应）。</li>
</ul>
</li>
<li><strong>协议单一且无状态</strong>：<ul>
<li><strong>SYN Flood</strong>： 海量的 <code>[SYN]</code> 包，但没有后续握手。</li>
<li><strong>UDP Flood</strong>： 海量的UDP包，内容通常随机或无意义。</li>
<li><strong>HTTP Flood</strong>： 海量的HTTP GET&#x2F;POST请求，但来自大量不同的IP（僵尸网络），行为模拟正常用户，难以单从协议上区分。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-持久化阶段：命令与控制"><a href="#5-持久化阶段：命令与控制" class="headerlink" title="5. 持久化阶段：命令与控制"></a>5. 持久化阶段：命令与控制</h4><p>攻击者建立对受害主机的远程控制通道。</p>
<ul>
<li><strong>主要通信方式</strong>： HTTP&#x2F;HTTPS, DNS, IRC, 自定义TCP&#x2F;UDP协议。</li>
<li><strong>核心流量特征</strong>：<ul>
<li><strong>周期性心跳</strong>： <strong>最典型的特征</strong>。受感染主机会以固定的时间间隔（如每30秒、60秒）向C2服务器发送一个小数据包（如一个HTTP GET请求，一个特定的DNS查询）。使用 <code>frame.time_delta</code> 过滤器可以辅助发现。</li>
<li><strong>长连接，小流量</strong>： 与C2服务器的连接可能持续数小时，但期间数据传输量很小，只是在等待命令。</li>
<li><strong>非标准端口使用</strong>： 在80或443端口上运行非HTTP&#x2F;HTTPS的协议，或者使用不常见的高端口号。</li>
<li><strong>DNS隧道</strong>：<ul>
<li>异常频繁的DNS查询，尤其是对TXT记录或AAAA记录的查询。</li>
<li>查询的域名通常非常长且随机（如 <code>kjasdhfkjasdhf.malicious.com</code>），用于封装外泄的数据或指令。</li>
<li>查询响应中包含编码后的数据。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="6-行动完成阶段：数据外泄"><a href="#6-行动完成阶段：数据外泄" class="headerlink" title="6. 行动完成阶段：数据外泄"></a>6. 行动完成阶段：数据外泄</h4><p>将窃取的敏感数据从内网传输到攻击者控制的服务器。</p>
<ul>
<li><strong>主要方式</strong>： FTP, HTTP POST, HTTPS, SCP, 或通过C2通道分块传输。</li>
<li><strong>核心流量特征</strong>：<ul>
<li><strong>出向流量激增</strong>： <strong>最核心的特征</strong>。一个内网IP会向某个外部IP发起大量的、持续的数据流出。在Conversations中按字节数排序，这个会话会非常突出。</li>
<li><strong>数据量不对称</strong>： 会话中，从内网到外网的流量（上传）远大于从外网到内网的流量（下载）。</li>
<li><strong>载荷特征</strong>：<ul>
<li>如果未加密，在TCP流中可能直接看到被窃文件的内容，如数据库表、文档内容、配置文件等。</li>
<li>即使加密，也能看到文件传输的迹象，例如在FTP传输中看到 <code>STOR secret.docx</code> 命令，或在HTTP中看到大量连续的 <code>POST</code> 请求携带加密数据。</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>总结表：</strong></p>
<table>
<thead>
<tr>
<th align="left">恶意操作</th>
<th align="left">关键流量特征</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>端口扫描</strong></td>
<td align="left">一源对多目标&#x2F;多端口，高频SYN包，低成功率握手</td>
</tr>
<tr>
<td align="left"><strong>暴力破解</strong></td>
<td align="left">固定目标端口，高频认证请求，大量失败响应</td>
</tr>
<tr>
<td align="left"><strong>漏洞利用</strong></td>
<td align="left">协议或载荷异常，包含超长字符串、SQL语句、系统命令</td>
</tr>
<tr>
<td align="left"><strong>拒绝服务</strong></td>
<td align="left">流量峰值，海量源IP或SYN包，目标单一，协议单一</td>
</tr>
<tr>
<td align="left"><strong>命令与控制</strong></td>
<td align="left">周期性心跳包，长连接小流量，非标准端口，异常DNS查询</td>
</tr>
<tr>
<td align="left"><strong>数据外泄</strong></td>
<td align="left">内网到外网的持续大流量，数据量不对称，可见文件内容&#x2F;命令</td>
</tr>
</tbody></table>
<p>掌握这些特征后，你在分析流量时就不再是漫无目的地查看，而是带着“症状清单”去进行“诊断”，从而能够高效、准确地定位出恶意活动和攻击者IP。</p>
<h2 id="web漏洞使用方法："><a href="#web漏洞使用方法：" class="headerlink" title="web漏洞使用方法："></a>web漏洞使用方法：</h2><ol>
<li><strong>扫描漏洞</strong>：</li>
</ol>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python web_security_fix.py --scan</span><br></pre></td></tr></table></figure>



<ol>
<li><strong>生成安全头配置</strong>：</li>
</ol>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python web_security_fix.py --generate-headers --output security_headers.json</span><br></pre></td></tr></table></figure>



<ol>
<li><strong>生成数据库安全配置</strong>：</li>
</ol>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python web_security_fix.py --generate-db-config mysql --output db_security.py</span><br></pre></td></tr></table></figure>



<ol>
<li><strong>生成文件上传验证</strong>：</li>
</ol>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python web_security_fix.py --generate-upload-validation --output file_upload.py</span><br></pre></td></tr></table></figure>



<h2 id="主要防护功能："><a href="#主要防护功能：" class="headerlink" title="主要防护功能："></a>主要防护功能：</h2><ol>
<li><strong>SQL注入防护</strong> - 参数化查询和输入验证</li>
<li><strong>XSS防护</strong> - 输入清理和输出编码</li>
<li><strong>CSRF防护</strong> - 令牌验证</li>
<li><strong>会话安全</strong> - 安全cookie配置</li>
<li><strong>文件上传安全</strong> - 类型和大小验证</li>
<li><strong>安全配置</strong> - HTTP安全头</li>
<li><strong>密码安全</strong> - 强哈希算法</li>
<li><strong>输入验证</strong> - 严格的数据验证规则</li>
</ol>
<p>这个脚本提供了全面的Web应用程序安全防护，可以有效防止大多数常见的Web漏洞攻击。</p>

    
  </article>

  
      

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1765187748340"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            
            <button class="mdui-fab catalog" style="overflow:unset;">
                <i class="nexmoefont icon-i-catalog"></i>
                <div class="nexmoe-toc">
                    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">场景概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%9A%E5%B8%B8%E8%A7%81%E7%9A%84%E6%81%B6%E6%84%8F%E6%93%8D%E4%BD%9C%E5%8F%8A%E5%85%B6%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81"><span class="toc-number">2.</span> <span class="toc-text">第一部分：常见的恶意操作及其流量特征</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E4%B8%8E%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0"><span class="toc-number">2.1.</span> <span class="toc-text">1. 端口扫描与主机发现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">2.2.</span> <span class="toc-text">2. 暴力破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">3. 漏洞利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="toc-number">2.4.</span> <span class="toc-text">4. 拒绝服务攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6"><span class="toc-number">2.5.</span> <span class="toc-text">5. 命令与控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E5%A4%96%E6%B3%84"><span class="toc-number">2.6.</span> <span class="toc-text">6. 数据外泄</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%EF%BC%9A%E5%A6%82%E4%BD%95%E5%9C%A8%E6%B5%81%E9%87%8F%E4%B8%AD%E5%88%86%E6%9E%90%E5%B9%B6%E7%A1%AE%E5%AE%9A%E6%94%BB%E5%87%BB%E8%80%85IP"><span class="toc-number">3.</span> <span class="toc-text">第二部分：如何在流量中分析并确定攻击者IP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E4%B8%80%EF%BC%9A%E5%AE%8F%E8%A7%82%E7%BB%9F%E8%AE%A1%EF%BC%8C%E5%AF%BB%E6%89%BE%E5%BC%82%E5%B8%B8"><span class="toc-number">3.1.</span> <span class="toc-text">步骤一：宏观统计，寻找异常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E4%BA%8C%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%BF%87%E6%BB%A4%E5%99%A8%E7%B2%BE%E5%87%86%E5%AE%9A%E4%BD%8D"><span class="toc-number">3.2.</span> <span class="toc-text">步骤二：使用过滤器精准定位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E4%B8%89%EF%BC%9A%E6%B7%B1%E5%85%A5%E6%B5%81%E9%87%8F%EF%BC%8C%E9%AA%8C%E8%AF%81%E5%88%A4%E6%96%AD"><span class="toc-number">3.3.</span> <span class="toc-text">步骤三：深入流量，验证判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E5%9B%9B%EF%BC%9A%E7%BB%BC%E5%90%88%E5%88%A4%E6%96%AD%E6%94%BB%E5%87%BB%E8%80%85IP"><span class="toc-number">3.4.</span> <span class="toc-text">步骤四：综合判断攻击者IP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B7%A5%E4%BD%9C%E6%B5%81"><span class="toc-number">4.</span> <span class="toc-text">总结与工作流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%81%B6%E6%84%8F%E6%93%8D%E4%BD%9C%E5%8F%8A%E5%85%B6%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81%EF%BC%88%E8%AF%A6%E8%A7%A3%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">常见的恶意操作及其流量特征（详解）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BE%A6%E5%AF%9F%E9%98%B6%E6%AE%B5%EF%BC%9A%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E4%B8%8E%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0"><span class="toc-number">5.1.</span> <span class="toc-text">1. 侦察阶段：端口扫描与主机发现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%85%A5%E4%BE%B5%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">5.2.</span> <span class="toc-text">2. 入侵阶段：暴力破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%85%A5%E4%BE%B5%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">5.3.</span> <span class="toc-text">3. 入侵阶段：漏洞利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%A0%B4%E5%9D%8F%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="toc-number">5.4.</span> <span class="toc-text">4. 破坏阶段：拒绝服务攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%8C%81%E4%B9%85%E5%8C%96%E9%98%B6%E6%AE%B5%EF%BC%9A%E5%91%BD%E4%BB%A4%E4%B8%8E%E6%8E%A7%E5%88%B6"><span class="toc-number">5.5.</span> <span class="toc-text">5. 持久化阶段：命令与控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E8%A1%8C%E5%8A%A8%E5%AE%8C%E6%88%90%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%A4%96%E6%B3%84"><span class="toc-number">5.6.</span> <span class="toc-text">6. 行动完成阶段：数据外泄</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E6%BC%8F%E6%B4%9E%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number"></span> <span class="toc-text">web漏洞使用方法：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E9%98%B2%E6%8A%A4%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-number"></span> <span class="toc-text">主要防护功能：</span></a>
                </div>
            </button>
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="搜索" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div></body></html>